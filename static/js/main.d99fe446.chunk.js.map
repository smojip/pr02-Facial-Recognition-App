{"version":3,"sources":["img/test.jpg","img/example.jpg","api/face.js","components/drawBox.js","components/showDescriptors.js","common/profile.js","views/faceRecognition.js","views/cameraFaceDetect.js","views/Home.js","components/Header.js","App.js","serviceWorker.js","index.js"],"names":["loadModels","a","MODEL_URL","process","faceapi","getFullFaceDescription","blob","inputSize","scoreThreshold","OPTION","useTinyModel","img","withFaceLandmarks","withFaceDescriptors","fullDesc","createMatcher","faceProfile","members","Object","keys","labeledDescriptors","map","member","name","descriptors","descriptor","Float32Array","faceMatcher","DrawBox","props","getDescription","setState","fd","detections","detection","state","findBestMatch","match","this","newProps","imageWidth","boxColor","box","i","relativeBox","dimension","_imageDims","_X","_x","_Y","_y","_height","_width","_W","width","_H","height","key","style","position","border","borderColor","transform","_label","backgroundColor","marginTop","color","Component","ShowDescriptors","update","display","flexDirection","alignContent","alignItems","padding","margin","wordBreak","borderStyle","toString","JSON_PROFILE","require","testImg","INIT_STATE","url","imageURL","imageDimension","error","loading","FaceRecognition","mounting","matcher","getImageDimension","handleImageChange","handleFileChange","event","resetState","URL","createObjectURL","target","files","handleURLChange","value","handleButtonClick","fetch","then","r","catch","type","includes","image","Image","onload","HEIGHT","WIDTH","src","handleDescriptorsCheck","showDescriptors","checked","isModelLoaded","tinyFaceDetector","params","document","documentElement","clientWidth","status","length","spinner","top","left","textShadow","className","alt","id","onChange","accept","placeholder","pattern","size","onClick","withRouter","CameraFaceDetect","setInputDevice","navigator","mediaDevices","enumerateDevices","devices","filter","device","kind","facingMode","exact","startCapture","interval","setInterval","capture","webcam","current","getScreenshot","React","createRef","clearInterval","videoConstraints","camera","audio","ref","screenshotFormat","exampleImage","Home","borderRadius","href","textAlign","marginLeft","Header","Link","to","App","Router","history","createHistory","basename","Route","path","component","Boolean","window","location","hostname","ReactDOM","render","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.d99fe446.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/test.058d2545.jpg\";","export default __webpack_public_path__ + \"static/media/example.eac5c617.jpg\";","import * as faceapi from 'face-api.js';\n\nconst maxDescriptorDistance = 0.5;\n\nexport async function loadModels() {\n  const MODEL_URL = process.env.PUBLIC_URL + '/models';\n  await faceapi.loadTinyFaceDetectorModel(MODEL_URL);\n  await faceapi.loadFaceLandmarkTinyModel(MODEL_URL);\n  await faceapi.loadFaceRecognitionModel(MODEL_URL);\n}\n\nexport async function getFullFaceDescription(blob, inputSize = 512) {\n  // tiny_face_detector options\n  let scoreThreshold = 0.5;\n  const OPTION = new faceapi.TinyFaceDetectorOptions({\n    inputSize,\n    scoreThreshold\n  });\n  const useTinyModel = true;\n\n  // fetch image to api\n  let img = await faceapi.fetchImage(blob);\n\n  // detect all faces and generate full description from image\n  // including landmark and descriptor of each face\n  let fullDesc = await faceapi\n    .detectAllFaces(img, OPTION)\n    .withFaceLandmarks(useTinyModel)\n    .withFaceDescriptors();\n  return fullDesc;\n}\n\nexport async function createMatcher(faceProfile) {\n  // Create labeled descriptors of member from profile\n  let members = Object.keys(faceProfile);\n  let labeledDescriptors = members.map(\n    member =>\n      new faceapi.LabeledFaceDescriptors(\n        faceProfile[member].name,\n        faceProfile[member].descriptors.map(\n          descriptor => new Float32Array(descriptor)\n        )\n      )\n  );\n\n  // Create face matcher (maximum descriptor distance is 0.5)\n  let faceMatcher = new faceapi.FaceMatcher(\n    labeledDescriptors,\n    maxDescriptorDistance\n  );\n  return faceMatcher;\n}\n\nexport function isFaceDetectionModelLoaded() {\n  return !!faceapi.nets.tinyFaceDetector.params;\n}\n","import React, { Component } from 'react';\n\nclass DrawBox extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      descriptors: null,\n      detections: null,\n      match: null\n    };\n  }\n\n  componentDidMount() {\n    this.getDescription();\n  }\n\n  componentWillReceiveProps(newProps) {\n    this.getDescription(newProps);\n  }\n\n  getDescription = async (props = this.props) => {\n    const { fullDesc, faceMatcher } = props;\n    if (!!fullDesc) {\n      await this.setState({\n        descriptors: fullDesc.map(fd => fd.descriptor),\n        detections: fullDesc.map(fd => fd.detection)\n      });\n      if (!!this.state.descriptors && !!faceMatcher) {\n        let match = await this.state.descriptors.map(descriptor =>\n          faceMatcher.findBestMatch(descriptor)\n        );\n        this.setState({ match });\n      }\n    }\n  };\n\n  render() {\n    const { imageWidth, boxColor } = this.props;\n    const { detections, match } = this.state;\n    let box = null;\n\n    if (!!detections) {\n      box = detections.map((detection, i) => {\n        const relativeBox = detection.relativeBox;\n        const dimension = detection._imageDims;\n        let _X = imageWidth * relativeBox._x;\n        let _Y =\n          (relativeBox._y * imageWidth * dimension._height) / dimension._width;\n        let _W = imageWidth * relativeBox.width;\n        let _H =\n          (relativeBox.height * imageWidth * dimension._height) /\n          dimension._width;\n        return (\n          <div key={i}>\n            <div\n              style={{\n                position: 'absolute',\n                border: 'solid',\n                borderColor: boxColor,\n                height: _H,\n                width: _W,\n                transform: `translate(${_X}px,${_Y}px)`\n              }}\n            >\n              {!!match && match[i] && match[i]._label !== 'unknown' ? (\n                <p\n                  style={{\n                    backgroundColor: boxColor,\n                    border: 'solid',\n                    borderColor: boxColor,\n                    width: _W,\n                    marginTop: 0,\n                    color: '#fff',\n                    transform: `translate(-3px,${_H}px)`\n                  }}\n                >\n                  {match[i]._label}\n                </p>\n              ) : null}\n            </div>\n          </div>\n        );\n      });\n    }\n\n    return <div>{box}</div>;\n  }\n}\n\nexport default DrawBox;\n","import React, { Component } from 'react';\n\nclass ShowDescriptors extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      descriptors: null\n    };\n  }\n\n  componentWillMount() {\n    this.update();\n  }\n\n  componentWillReceiveProps(newProps) {\n    this.update(newProps);\n  }\n\n  update = (props = this.props) => {\n    let { fullDesc } = props;\n    if (!!fullDesc) {\n      this.setState({\n        descriptors: fullDesc.map(fd => fd.descriptor)\n      });\n    }\n  };\n\n  render() {\n    const { descriptors } = this.state;\n\n    return (\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignContent: 'center',\n          alignItems: 'center'\n        }}\n      >\n        <h3>Detail Descriptions</h3>\n        {!!descriptors\n          ? descriptors.map((descriptor, i) => (\n              <p\n                key={i}\n                style={{\n                  padding: 10,\n                  margin: 20,\n                  wordBreak: 'break-all',\n                  borderStyle: 'solid',\n                  borderColor: 'blue'\n                }}\n              >\n                <strong>Descriptor_{i}: </strong>\n                {descriptor.toString()}\n              </p>\n            ))\n          : null}\n      </div>\n    );\n  }\n}\n\nexport default ShowDescriptors;\n","// Descriptors profile\nexport const JSON_PROFILE = require('../descriptors/pr02_Facial_Recognition_App.json');\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport {\n  loadModels,\n  getFullFaceDescription,\n  createMatcher,\n  isFaceDetectionModelLoaded\n} from '../api/face';\nimport DrawBox from '../components/drawBox';\nimport ShowDescriptors from '../components/showDescriptors';\nimport { JSON_PROFILE } from '../common/profile';\n\nconst MaxWidth = 600;\nconst boxColor = '#BE80B5';\nconst testImg = require('../img/test.jpg');\n\nconst INIT_STATE = {\n  url: null,\n  imageURL: null,\n  fullDesc: null,\n  imageDimension: null,\n  error: null,\n  loading: false\n};\n\nclass FaceRecognition extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ...INIT_STATE,\n      faceMatcher: null,\n      showDescriptors: false,\n      WIDTH: null,\n      HEIGHT: 0,\n      isModelLoaded: !!isFaceDetectionModelLoaded()\n    };\n  }\n\n  componentWillMount() {\n    this.resetState();\n    let _W = document.documentElement.clientWidth;\n    if (_W > MaxWidth) _W = MaxWidth;\n    this.setState({ WIDTH: _W });\n    this.mounting();\n  }\n\n  mounting = async () => {\n    await loadModels();\n    await this.matcher();\n    await this.getImageDimension(testImg);\n    await this.setState({ imageURL: testImg, loading: true });\n    await this.handleImageChange(testImg);\n  };\n\n  matcher = async () => {\n    const faceMatcher = await createMatcher(JSON_PROFILE);\n    this.setState({ faceMatcher });\n  };\n\n  handleFileChange = async event => {\n    this.resetState();\n    await this.setState({\n      imageURL: URL.createObjectURL(event.target.files[0]),\n      loading: true\n    });\n    this.handleImageChange();\n  };\n\n  handleURLChange = event => {\n    this.setState({ url: event.target.value });\n  };\n\n  handleButtonClick = async () => {\n    this.resetState();\n    let blob = await fetch(this.state.url)\n      .then(r => r.blob())\n      .catch(error => this.setState({ error }));\n    if (!!blob && blob.type.includes('image')) {\n      this.setState({\n        imageURL: URL.createObjectURL(blob),\n        loading: true\n      });\n      this.handleImageChange();\n    }\n  };\n\n  handleImageChange = async (image = this.state.imageURL) => {\n    await this.getImageDimension(image);\n    await getFullFaceDescription(image).then(fullDesc => {\n      this.setState({ fullDesc, loading: false });\n    });\n  };\n\n  getImageDimension = imageURL => {\n    let img = new Image();\n    img.onload = () => {\n      let HEIGHT = (this.state.WIDTH * img.height) / img.width;\n      this.setState({\n        HEIGHT,\n        imageDimension: {\n          width: img.width,\n          height: img.height\n        }\n      });\n    };\n    img.src = imageURL;\n  };\n\n  handleDescriptorsCheck = event => {\n    this.setState({ showDescriptors: event.target.checked });\n  };\n\n  resetState = () => {\n    this.setState({ ...INIT_STATE });\n  };\n  render() {\n    const {\n      WIDTH,\n      HEIGHT,\n      imageURL,\n      fullDesc,\n      faceMatcher,\n      showDescriptors,\n      isModelLoaded,\n      error,\n      loading\n    } = this.state;\n\n    // Display working status\n    let status = <p>Status: Model Loaded = {isModelLoaded.toString()}</p>;\n    if (!!error && error.toString() === 'TypeError: Failed to fetch') {\n      status = (\n        <p style={{ color: 'red' }}>Status: Error Failed to fetch Image URL</p>\n      );\n    } else if (loading) {\n      status = <p style={{ color: 'blue' }}>Status: LOADING...</p>;\n    } else if (!!fullDesc && !!imageURL && !loading) {\n      if (fullDesc.length < 2)\n        status = <p>Status: {fullDesc.length} Face Detect</p>;\n      if (fullDesc.length > 1)\n        status = <p>Status: {fullDesc.length} Faces Detect</p>;\n    }\n\n    // Loading Spinner\n    let spinner = (\n      <div\n        style={{\n          margin: 0,\n          color: '#BE80B5',\n          position: 'absolute',\n          top: '50%',\n          left: '50%',\n          transform: 'translate(-50%,-50%)',\n          textShadow: '2px 2px 3px #fff'\n        }}\n      >\n        <div className=\"loading\" />\n        <h3>Processing...</h3>\n      </div>\n    );\n\n    return (\n      <div\n        style={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center'\n        }}\n      >\n        {status}\n        <div\n          style={{\n            position: 'relative',\n            width: WIDTH,\n            height: HEIGHT\n          }}\n        >\n          {!!imageURL ? (\n            <div\n              style={{\n                position: 'relative'\n              }}\n            >\n              <div style={{ position: 'absolute' }}>\n                <img style={{ width: WIDTH }} src={imageURL} alt=\"imageURL\" />\n              </div>\n              {!!fullDesc ? (\n                <DrawBox\n                  fullDesc={fullDesc}\n                  faceMatcher={faceMatcher}\n                  imageWidth={WIDTH}\n                  boxColor={boxColor}\n                />\n              ) : null}\n            </div>\n          ) : null}\n          {loading ? spinner : null}\n        </div>\n        <div\n          style={{\n            width: WIDTH,\n            padding: 10,\n            border: 'solid',\n            marginTop: 10\n          }}\n        >\n          <p>Input Image file or URL</p>\n          <input\n            id=\"myFileUpload\"\n            type=\"file\"\n            onChange={this.handleFileChange}\n            accept=\".jpg, .jpeg, .png\"\n          />\n          <br />\n          <div className=\"URLInput\">\n            <input\n              type=\"url\"\n              name=\"url\"\n              id=\"url\"\n              placeholder=\"Place your photo URL here (only .jpg, .jpeg, .png)\"\n              pattern=\"https://.*\"\n              size=\"30\"\n              onChange={this.handleURLChange}\n            />\n            <button onClick={this.handleButtonClick}>Upload</button>\n          </div>\n          <div>\n            <input\n              name=\"descriptors\"\n              type=\"checkbox\"\n              checked={this.state.showDescriptors}\n              onChange={this.handleDescriptorsCheck}\n            />\n            <label>Show Descriptors</label>\n          </div>\n          {!!showDescriptors ? <ShowDescriptors fullDesc={fullDesc} /> : null}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(FaceRecognition);\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport Webcam from 'react-webcam';\nimport { loadModels, getFullFaceDescription, createMatcher } from '../api/face';\nimport DrawBox from '../components/drawBox';\nimport { JSON_PROFILE } from '../common/profile';\n\nconst WIDTH = 420;\nconst HEIGHT = 420;\nconst inputSize = 160;\n\nclass CameraFaceDetect extends Component {\n  constructor(props) {\n    super(props);\n    this.webcam = React.createRef();\n    this.state = {\n      fullDesc: null,\n      faceMatcher: null,\n      facingMode: null\n    };\n  }\n\n  componentWillMount() {\n    loadModels();\n    this.setInputDevice();\n    this.matcher();\n  }\n\n  setInputDevice = () => {\n    navigator.mediaDevices.enumerateDevices().then(async devices => {\n      let inputDevice = await devices.filter(\n        device => device.kind === 'videoinput'\n      );\n      if (inputDevice.length < 2) {\n        await this.setState({\n          facingMode: 'user'\n        });\n      } else {\n        await this.setState({\n          facingMode: { exact: 'environment' }\n        });\n      }\n      this.startCapture();\n    });\n  };\n\n  matcher = async () => {\n    const faceMatcher = await createMatcher(JSON_PROFILE);\n    this.setState({ faceMatcher });\n  };\n\n  startCapture = () => {\n    this.interval = setInterval(() => {\n      this.capture();\n    }, 1500);\n  };\n\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n\n  capture = async () => {\n    if (!!this.webcam.current) {\n      await getFullFaceDescription(\n        this.webcam.current.getScreenshot(),\n        inputSize\n      ).then(fullDesc => this.setState({ fullDesc }));\n    }\n  };\n\n  render() {\n    const { fullDesc, faceMatcher, facingMode } = this.state;\n    let videoConstraints = null;\n    let camera = '';\n    if (!!facingMode) {\n      videoConstraints = {\n        width: WIDTH,\n        height: HEIGHT,\n        facingMode: facingMode\n      };\n      if (facingMode === 'user') {\n        camera = 'Front';\n      } else {\n        camera = 'Back';\n      }\n    }\n\n    return (\n      <div\n        className=\"Camera\"\n        style={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center'\n        }}\n      >\n        <p>Camera: {camera}</p>\n        <div\n          style={{\n            width: WIDTH,\n            height: HEIGHT\n          }}\n        >\n          <div style={{ position: 'relative', width: WIDTH }}>\n            {!!videoConstraints ? (\n              <div style={{ position: 'absolute' }}>\n                <Webcam\n                  audio={false}\n                  width={WIDTH}\n                  height={HEIGHT}\n                  ref={this.webcam}\n                  screenshotFormat=\"image/jpeg\"\n                  videoConstraints={videoConstraints}\n                />\n              </div>\n            ) : null}\n            {!!fullDesc ? (\n              <DrawBox\n                fullDesc={fullDesc}\n                faceMatcher={faceMatcher}\n                imageWidth={WIDTH}\n                boxColor={'blue'}\n              />\n            ) : null}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(CameraFaceDetect);\n","import React, { Component } from 'react';\n\nconst exampleImage = require('../img/example.jpg');\n\nexport default class Home extends Component {\n  render() {\n    const WIDTH = document.documentElement.clientWidth;\n    return (\n      <div\n        style={{\n          border: 'solid',\n          borderRadius: 8,\n          width: { WIDTH },\n          margin: 10,\n          padding: 5\n        }}\n      >\n        <h2>BNK48 Facial Recognition App</h2>\n        <h4>\n          Single Page App for face detection and recognition of BNK48 idol\n          group, running in front-end browser using React and{' '}\n          <a href=\"https://github.com/justadudewhohacks/face-api.js\">\n            face-api.js\n          </a>{' '}\n          (without back-end)\n        </h4>\n        <img src={exampleImage} alt=\"example\" width=\"350\" />\n\n        <div\n          style={{\n            display: 'flex',\n            flexDirection: 'column',\n            textAlign: 'left',\n            margin: 'auto',\n            marginLeft: 10\n          }}\n        >\n          <h3>How to Use</h3>\n          <p>\n            This App try to detect all faces from input image and recognize if\n            any faces are BNK48 member. Member's name will be displayed under\n            face box if recognized. Only the current members (as of December\n            2018) are listed for this App to recognize.\n          </p>\n          <div>\n            <ul>\n              <h4>Requirement:</h4>\n              <li>\n                Support any PC browser with Javascript enabled (Chrome, IE,\n                Safari)\n              </li>\n              <li>Support Android phone for Photo Input and Video Camera</li>\n              <li>Support Iphone on Safari and Chrome only for Photo Input</li>\n              <li>Not support older smartphone (such as Iphone4)</li>\n            </ul>\n            <ul>\n              <h4>Photo Input:</h4>\n              <li>Input image can be image file or URL</li>\n              <li>Image file must be jpg, jpeg, or png format</li>\n              <li>\n                Image URL host should allow cross-origin requests (CORS) or else\n                the App will not be able to access the image. (any facebook\n                images are good for testing with this App)\n              </li>\n              <li>\n                The App will try to detect all faces, which might take few\n                seconds depend on how many faces are in the image.\n              </li>\n              <li>\n                Face detection can be difficult if the object face is tilted,\n                too large or too small, and/or blurry face.\n              </li>\n              <li>\n                The App might recognize member wrongly if their face look\n                similar, or the object face does not look straight to camera.\n              </li>\n              <li>\n                This App may not work well for older smartphone or in some\n                browsers. (I found my Iphone4 cannot process detection properly,\n                while iphone7 or 8 are working fine.)\n              </li>\n            </ul>\n            <ul>\n              <h4>Video Camera:</h4>\n              <li>\n                Video Input works well with PC webcam or Android phone's camera.\n              </li>\n              <li>\n                Currently Iphone camera is not supported for live detection in\n                this App.\n              </li>\n              <li>\n                App will try to detect and recognize any faces, but performance\n                depends on CPU of the device.\n              </li>\n              <li>\n                Detection and Recognition with PC webcam can be fast, while\n                working on smartphone can be slower.\n              </li>\n            </ul>\n            <ul>\n              <h4>Reference:</h4>\n              <li>\n                Find more information of my code and API in{' '}\n                <a href=\"https://github.com/supachaic/bnk48-face-recognition\">\n                  My Repo\n                </a>\n              </li>\n              <li>\n                Tutorial for this App in my Medium:{' '}\n                <a href=\"https://medium.com/@supachaic/facial-recognition-spa-for-bnk48-idol-group-using-react-and-face-api-js-ad62b43ec5b6\">\n                  Facial Recognition SPA for BNK48 Idol group using React and\n                  face-api.js\n                </a>\n              </li>\n              <li>\n                face-api.js API{' '}\n                <a href=\"https://github.com/justadudewhohacks/face-api.js\">\n                  repo\n                </a>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\n\nclass Header extends Component {\n  render() {\n    return (\n      <header>\n        <div className=\"Navbar\">\n          <Link to=\"/\">Home</Link>\n          <Link to=\"/photo\">Photo Input</Link>\n          <Link to=\"/camera\">Video Camera</Link>\n        </div>\n      </header>\n    );\n  }\n}\n\nexport default Header;\n","import React, { Component } from 'react';\nimport { Route, Router } from 'react-router-dom';\nimport createHistory from 'history/createBrowserHistory';\nimport FaceRecognition from './views/faceRecognition';\nimport CameraFaceDetect from './views/cameraFaceDetect';\nimport Home from './views/Home';\nimport Header from './components/Header';\nimport './App.css';\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        <Router history={createHistory({ basename: process.env.PUBLIC_URL })}>\n          <div className=\"route\">\n            <Header />\n            <Route exact path=\"/\" component={Home} />\n            <Route exact path=\"/photo\" component={FaceRecognition} />\n            <Route exact path=\"/camera\" component={CameraFaceDetect} />\n          </div>\n        </Router>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}